# Shipment App with FastApi

## Setup Fast API
make sure you already setup your environment and install dependency

```sh
pip install -r requirements.txt
```

## Setup migration
after install alembic

for init
```sh
alembic init -t async migrations
```

for add migration file
```sh
alembic revision -m <message> 
```

for run migration
```sh
alembic upgrade head
```
or for specific hash
```sh
alembic upgrade <name hash>
```

for check current migration
```sh
alembic current
```

for rollback migration
```sh
alembic downgrade <name hash>
```
```sh
alembuc downgrade -1
```

for autogenerated revision
```sh
alembic revision --autogenerate -m <message>
```

## Get Library
```sh
pip freeze > requirements.txt
```

## Worker
```sh
celery -A app.worker.tasks worker -L info -P solo (for development)
celery -A app.worker.tasks worker -L info -P gevent (for production)
```

for monitoring, run first
```sh
celery -A app.worker.tasks worker -E
```

then run flower
```sh
celery -A app.worker.tasks flower
```

for set credentials
```sh
celery -A app.worker.tasks flower --basic-auth=<username>:<password>
```